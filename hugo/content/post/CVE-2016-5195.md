---
title: "CVE-2016-5195 Linux DirtyCOW漏洞分析"
description: "经典的内核提权漏洞"
date: 2022-05-24T17:43:25+08:00
tags: [ "Vulnerability", "Linux" ]
imagelink: https://s2.loli.net/2022/05/24/JFAS5mGpYn9utWi.jpg
---



# 背景知识

## DirtyCOW

- [https://dirtycow.ninja/](https://dirtycow.ninja/)
- [https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs](https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs)
- [https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails](https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails)

## Copy on Write

- [https://www.cnblogs.com/biyeymyhjob/archive/2012/07/20/2601655.html](https://www.cnblogs.com/biyeymyhjob/archive/2012/07/20/2601655.html)
- [https://blog.csdn.net/puliao4167/article/details/87894191](https://blog.csdn.net/puliao4167/article/details/87894191)

## Page Cache

- [https://en.wikipedia.org/wiki/Page_cache](https://en.wikipedia.org/wiki/Page_cache)

## mmap

- [https://www.cnblogs.com/huxiao-tee/p/4660352.html](https://www.cnblogs.com/huxiao-tee/p/4660352.html)

## 内核文件系统

- [https://www.cnblogs.com/huxiao-tee/p/4657851.html](https://www.cnblogs.com/huxiao-tee/p/4657851.html)



# 漏洞复现

## 环境准备

### Linux Kernel

选取一个有漏洞的版本4.4.0，下载ubuntu对应的deb包。解压得到`./boot/vmlinuz-4.4.0-31-generic`

```sh
wget http://security.ubuntu.com/ubuntu/pool/main/l/linux/linux-image-4.4.0-31-generic_4.4.0-31.50_amd64.deb
ar xv linux-image-4.4.0-31-generic_4.4.0-31.50_amd64.deb
tar jxvf data.tar.bz2
```







# 漏洞分析





