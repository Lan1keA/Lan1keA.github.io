---
title: "CVE-2021-3156 sudo 提权漏洞分析"
description: "nothing"
date: 2022-05-13T23:02:59+08:00
tags: [ "漏洞分析" ]
---



> CVE-2021-3156是sudo中存在一个堆溢出漏洞。影响从1.8.2~1.8.31p2下的所有旧版本sudo，以及1.9.0~1.9.5p1的所有稳定版sudo。可以使得任何没有特权的用户均可使用默认的sudo配置获取root权限



## 环境准备

使用apt获取软件源提供的sudo源码：

```sh
sudo apt source sudo
```

却被告知：

```tex
NOTICE: 'sudo' packaging is maintained in the 'Git' version control system at:
https://salsa.debian.org/sudo-team/sudo.git
Please use:
git clone https://salsa.debian.org/sudo-team/sudo.git
to retrieve the latest (possibly unreleased) updates to the package.
```

于是听话，从git仓库获取源码：

```sh
git clone https://salsa.debian.org/sudo-team/sudo.git
```

接下来进行构建：

```sh
# clone configure make
git reset --hard 36955b3ef399efeea25824d32e6cfbaa444e9f07 # v1.9.5p1
./configure --sysconfdir=`pwd`/examples --with-plugindir=`pwd`/plugins/sudoers/.libs
make -j`nproc`

# 修改依赖文件所有者以便sudo正常执行
sudo chown root:root examples/sudo.conf
sudo chown root:root examples/sudoers
sudo chown root:root plugins/sudoers/.libs/sudoers.so
```



