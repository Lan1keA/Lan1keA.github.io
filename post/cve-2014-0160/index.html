<!DOCTYPE html>
<html lang="zh"><head>
    <meta charset="UTF-8">
    <title>やれやれ DA✰ZE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="借助于libFuzzer进行Fuzzing" />
    <meta property="og:title" content="CVE-2014-0160 心脏滴血漏洞挖掘与分析" />
    <meta property="og:description" content="借助于libFuzzer进行Fuzzing" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://cerr.cc/post/cve-2014-0160/" />
    <meta itemprop="name" content="CVE-2014-0160 心脏滴血漏洞挖掘与分析">
    <meta itemprop="description" content="借助于libFuzzer进行Fuzzing">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
    
    <link rel="stylesheet" href="https://cerr.cc/scss/style.min.8cf7a5758f9d406f171a1184f6b6ec0a6175c7d809e6dd601dd4878d8acf96b1.css" >
</head>
<body>
    <header>
    <div class="header header-frame">
        <div>
          
            <h1 class="header__title">CVE-2014-0160 心脏滴血漏洞挖掘与分析</h1>
          
            
                <div class="header__description">借助于libFuzzer进行Fuzzing</div>
            
        </div>
        <nav class="header-nav">
            <ul class="header-nav-list header-nav-list--menu">
                
                
                    
                        <li class="header-nav-list__item">
                            <a class="header-nav-list__link" href="/main/about/">
                                
                                <span>About</span>
                            </a>
                        </li>
                    
                
                    
                        <li class="header-nav-list__item">
                            <a class="header-nav-list__link" href="/main/board/">
                                
                                <span>Board</span>
                            </a>
                        </li>
                    
                
                    
                        <li class="header-nav-list__item">
                            <a class="header-nav-list__link" href="/main/flink/">
                                
                                <span>Flink</span>
                            </a>
                        </li>
                    
                
                    
                        <li class="header-nav-list__item">
                            <a class="header-nav-list__link" href="/main/utils/">
                                
                                <span>Utils</span>
                            </a>
                        </li>
                    
                
                    
                        <li class="header-nav-list__item">
                            <a class="header-nav-list__link" href="/main/love/">
                                
                                <span>Love</span>
                            </a>
                        </li>
                    
                
                    
                        <li class="header-nav-list__item">
                            <a class="header-nav-list__link" href="/main/ilus/">
                                
                                <span>Ilus</span>
                            </a>
                        </li>
                    
                
            </ul>
            <button class="header-nav-list__nav-btn">~#</button>
        </nav>
        <button class="mb-header__menu-btn">
            <span class="mb-header__menu-btn-line"></span>
            <span class="mb-header__menu-btn-line"></span>
            <span class="mb-header__menu-btn-line"></span>
        </button>
    </div>
    <nav id="mobile-header-nav" class="mb-header-nav">
  
  
  <button class="mb-header-nav__close-btn flex-center">
    <svg
            class="mb-header-nav__svg-icon"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="32"
            height="32"
            >
            <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                />
            <path d="M0 0h24v24H0z" fill="none" />
        </svg>
    </button>
    
    <div class="mb-header-nav__wrapper">
        <div class="mb-header-nav__container">
            <svg
                width="240"
                height="72"
                viewBox="0 0 240 72"
                class="mb-header-nav__title"
                >
                <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">
                Tags
                </text>
            </svg>
            <ul class="mb-header-nav-list">
                
                    
                        
                          <li class="mb-header-nav-list__item ">
                        <a class="mb-header-nav-list__link" href="https://cerr.cc/tags/vulnerability/"
                                                            >Vulnerability</a
                                                        >
                    </li>
                        
                    
                        
                          <li class="mb-header-nav-list__item ">
                        <a class="mb-header-nav-list__link" href="https://cerr.cc/tags/fuzzing/"
                                                            >Fuzzing</a
                                                        >
                    </li>
                        
                    
                
            </ul>
        </div>
        <div class="mb-header-nav__container">
            <svg
                width="240"
                height="72"
                viewBox="0 0 240 72"
                class="mb-header-nav__title"
                >
                <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">
                Menu
                </text>
            </svg>
            <ul class="mb-header-nav-list">
                
                
                    
                      <li class="mb-header-nav-list__item ">
                            <a class="mb-header-nav-list__link" href="/main/about/">
                                About
                            </a>
                        </li>
                    
                
                    
                      <li class="mb-header-nav-list__item ">
                            <a class="mb-header-nav-list__link" href="/main/board/">
                                Board
                            </a>
                        </li>
                    
                
                    
                      <li class="mb-header-nav-list__item ">
                            <a class="mb-header-nav-list__link" href="/main/flink/">
                                Flink
                            </a>
                        </li>
                    
                
                    
                      <li class="mb-header-nav-list__item ">
                            <a class="mb-header-nav-list__link" href="/main/utils/">
                                Utils
                            </a>
                        </li>
                    
                
                    
                      <li class="mb-header-nav-list__item ">
                            <a class="mb-header-nav-list__link" href="/main/love/">
                                Love
                            </a>
                        </li>
                    
                
                    
                      <li class="mb-header-nav-list__item ">
                            <a class="mb-header-nav-list__link" href="/main/ilus/">
                                Ilus
                            </a>
                        </li>
                    
                
            </ul>
        </div>
    </div>
</nav>

</header>



    <div id="content">
<article class="post">
  
    <div class="post-content"><blockquote>
<p>漏洞编号：CVE-2014-0160</p>
<p>漏洞类型：内存越界访问</p>
<p>漏洞危害：信息泄露</p>
<p>影响范围：OpenSSL1.0.1、OpenSSL 1.0.1a~ OpenSSL 1.0.1f、OpenSSL 1.0.2-beta</p>
<p>漏洞描述：OpenSSL 在实现 TLS（传输层安全协议）和 DTLS（数据报安全传输协议）的心跳包处理逻辑时存在问题。OpenSSL 的 Heartbleed 模块在处理心跳包时没有检查心跳包中的长度字段是否与后续的数据字段一致，攻击者利用该漏洞构造异常数据包，可获取服务器内存中多达 64KB 的数据。这些数据可能会包含证书私钥、用户账号、密码、邮件内容等敏感信息。</p>
</blockquote>
<h1 id="背景知识">背景知识</h1>
<h2 id="简介">简介</h2>
<p><a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">传输层安全性协议SSL</a></p>
<p><strong>SSL</strong> 全称 Secure Sockets Layer（安全套接字层协议），要求建立在可靠的传输层协议（<strong>TCP</strong>）之上，主要提供机密性、认证性及数据完整性服务。SSL 最初（SSL 1.0、SSL2.0、SSL 3.0 版本）由网景公司设计和维护，从 3.1 版本开始，SSL 协议由因特网工程任务小组（IETF）正式接管，并更名为 <strong>TLS</strong>（传输层安全协议，Transport Layer Security），发展至今已有 TLS 1.0、TLS1.1、TLS1.2 三个版本。</p>
<p>SSL/TLS 协议能够提供的安全服务主要包括：</p>
<ul>
<li>认证性——使用数字证书认证服务器和客户端身份，防止身份伪造；</li>
<li>机密性——使用加密算法防止第三方窃听；</li>
<li>完整性——使用消息认证码（MAC）保障数据完整性，防止消息被篡改；</li>
<li>重放保护——通过使用隐式序列号防止重放攻击；</li>
</ul>
<h2 id="ssl握手过程">SSL握手过程</h2>
<p>客户端获取服务器的数字证书后，协商后续数据传输所使用的对称加密密钥。</p>
<p><img src="https://s2.loli.net/2022/05/23/v2tSmBZsi1PWHTO.png" alt="img"></p>
<h2 id="ssl-heartbeat">SSL Heartbeat</h2>
<blockquote>
<p>Heartbleed was introduced by the Heartbeat Extension in the OpenSSL version 1.0.11 . This extension enables a low-cost, keepalive mechanism for peers to know that they’re still connected and all is well at the TLS layer. Standard implementations of TLS do not require the extension as they can rely on TCP for equivalent session management. Version 1.0.1 of OpenSSL added support for the Heartbeat functionality and enabled it by default.</p>
</blockquote>
<p>文档：<a href="https://datatracker.ietf.org/doc/html/rfc6520">Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) Heartbeat Extension</a></p>
<p>SSL 协议完成握手过程后，客户端和服务器间便建立安全可靠的通信。SSL 安全协议工作在传输层的 TCP 协议之上，所以服务器和客户端需要保持持续连接的状态。由于服务器的资源有限，当连接的客户端数量较大时，服务器要维持这些连接将会消耗很多资源，因此需要及时断开完成通信的客户端以减少服务器的负载压力。服务器通过 SSL 的心跳机制可判断客户端是否已完成通信。</p>
<p>SSL 协议中的心跳机制工作于 SSL 记录协议之上，心跳机制中包含两种类型的消息：心跳请求消息（HeartbeatRequest Message）和心跳响应消息（HeartbeatResponse Message），这两种消息具有相同的包结构。当服务器和客户端完成 SSL 协议的握手阶段后，如果客户端一段时间没有与服务器进行数据交互，客户端需要周期性地向服务器发送心跳请求消息。服务器接收到客户端的心跳请求消息，则认为客户端还没有完成通信，继续维持客户端和服务器的连接，并向客户端发送心跳响应消息。</p>
<p>通信双方在建立 SSL 连接时可协商是否支持心跳机制。在 SSL 第一次握手过程中通过 Client Hello 消息和 Server Hello 消息的 Heartbeat Hello 扩展告知对方是否支持心跳机制。Heartbeat Hello 扩展的格式如下。当支持心跳机制时设置 HeartbeatMode 为 peer_allowed_to_send，可接收心跳请求消息并能返回响应包；当不支持心跳机制时设置 HeartbeatMode 为 peer_not_allowed_to_send，若对端发送心跳请求消息，将会丢弃该消息并返回 unexpected_message 警告消息。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">enum</span> {
</span></span><span style="display:flex;"><span>    peer_allowed_to_send(<span style="color:#099">1</span>),
</span></span><span style="display:flex;"><span>    peer_not_allowed_to_send(<span style="color:#099">2</span>),
</span></span><span style="display:flex;"><span>} HeartbeatMode;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>    HeartbeatMode mode;
</span></span><span style="display:flex;"><span>} HeartbeatExtension;
</span></span></code></pre></div><p>心跳包的结构如下图所示，前半部分为 SSL 记录头，Content Type 为消息类型（0x18 表示心跳包消息），TLS Version 为 SSL 版本信息，Record length 为记录长度；后半部分即为心跳消息。</p>
<p><img src="https://s2.loli.net/2022/05/23/rfcnZhoetL6jK9C.png" alt="img"></p>
<p>其中，SSL 记录长度（Record length）为心跳消息的总长度。心跳包消息由数据包类型（type）、载荷长度（payload length）、载荷内容（payload）和填充字节（padding）组成。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">struct</span> {
</span></span><span style="display:flex;"><span>      HeartbeatMessageType type;    <span style="color:#998;font-style:italic">// 1 bytes，包括request和response两种类型
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      uint16 payload_length;    <span style="color:#998;font-style:italic">// 2 bytes，载荷长度
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      opaque payload[HeartbeatMessage.payload_length];    <span style="color:#998;font-style:italic">// payload_length bytes，载荷内容
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      opaque padding[padding_length];    <span style="color:#998;font-style:italic">// 填充字节，至少为16 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>} HeartbeatMessage;
</span></span></code></pre></div><p>下图为心跳请求包的数据包实例，其载荷长度为 5 bytes：</p>
<p><img src="https://s2.loli.net/2022/05/23/i6WzNbtolc4VrZn.png" alt="1586019909_91460635.jpg"></p>
<h2 id="openssl">OpenSSL</h2>
<p><a href="https://www.openssl.org/">https://www.openssl.org/</a></p>
<p>查阅文档：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>man <span style="color:#099">7</span> crypto
</span></span></code></pre></div><blockquote>
<p>The OpenSSL crypto library (<code>libcrypto</code>) implements a wide range of cryptographic algorithms used in various Internet standards. The services provided by this library are used by the OpenSSL implementations of TLS and CMS, and they have also been used to implement many other third party products and protocols.</p>
<p>The functionality includes symmetric encryption, public key cryptography, key agreement, certificate handling, cryptographic hash functions, cryptographic pseudo-random number generators, message authentication codes (MACs), key derivation functions (KDFs), and various utilities.</p>
</blockquote>
<h1 id="漏洞分析">漏洞分析</h1>
<h2 id="源码获取">源码获取</h2>
<p>获取含漏洞的源码：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git clone git://git.openssl.org/openssl.git
</span></span><span style="display:flex;"><span><span style="color:#0086b3">cd</span> openssl
</span></span><span style="display:flex;"><span>git checkout OpenSSL_1_0_1f
</span></span></code></pre></div><p>OpenSSL 是 SSL 协议实现的开源软件包，存在漏洞的两个文件为 ssl/d1_both.c 和 ssl/t1_lib.c，这两个文件中的 dtls1_process_heartbeat 函数和 tls1_process_heartbeat 函数分别为 DTLS（数据报安全传输协议）和 TLS（传输层安全协议）处理心跳请求包的函数。两函数的实现完全相同，此处选取 dtls1_process_heartbeat 进行分析。</p>
<h2 id="成因预习">成因预习</h2>
<p><img src="https://s2.loli.net/2022/05/23/7bzQV5f1GZLcCgl.jpg" alt="Snipaste_2022-05-23_18-12-44.jpg"></p>
<h2 id="代码分析">代码分析</h2>
<p>预习完后首先来看看出现漏洞的函数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#ifndef OPENSSL_NO_HEARTBEATS
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">dtls1_process_heartbeat</span>(SSL <span style="color:#000;font-weight:bold">*</span>s)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>p <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">&amp;</span>s<span style="color:#000;font-weight:bold">-&gt;</span>s3<span style="color:#000;font-weight:bold">-&gt;</span>rrec.data[<span style="color:#099">0</span>], <span style="color:#000;font-weight:bold">*</span>pl;
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>}
</span></span></code></pre></div><p>我们发现，为了完整弄清楚该函数中的逻辑，我们还需了解参数SSL的定义：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/* crypto/ossl_tpy.h */</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">typedef</span> <span style="color:#000;font-weight:bold">struct</span> ssl_st SSL;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/* ssl/ssl.h */</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">struct</span> ssl_st
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">struct</span> ssl2_state_st <span style="color:#000;font-weight:bold">*</span>s2;  <span style="color:#998;font-style:italic">/* SSLv2 variables */</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">struct</span> ssl3_state_st <span style="color:#000;font-weight:bold">*</span>s3;  <span style="color:#998;font-style:italic">/* SSLv3 variables */</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">struct</span> dtls1_state_st <span style="color:#000;font-weight:bold">*</span>d1; <span style="color:#998;font-style:italic">/* DTLSv1 variables */</span>
</span></span><span style="display:flex;"><span>	...
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/* ssl/ssl3.h */</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">typedef</span> <span style="color:#000;font-weight:bold">struct</span> ssl3_state_st
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	...
</span></span><span style="display:flex;"><span>	SSL3_RECORD rrec;	<span style="color:#998;font-style:italic">/* each decoded record goes in here */</span>
</span></span><span style="display:flex;"><span>	...
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/* ssl/ssl3.h */</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">typedef</span> <span style="color:#000;font-weight:bold">struct</span> ssl3_record_st
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*r */</span>	<span style="color:#458;font-weight:bold">int</span> type;                  <span style="color:#998;font-style:italic">/* type of record */</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*rw*/</span>	<span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">int</span> length;       <span style="color:#998;font-style:italic">/* How many bytes available */</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*r */</span>	<span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">int</span> off;          <span style="color:#998;font-style:italic">/* read/write offset into &#39;buf&#39; */</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*rw*/</span>	<span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>data;       <span style="color:#998;font-style:italic">/* pointer to the record data */</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*rw*/</span>	<span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>input;      <span style="color:#998;font-style:italic">/* where the decode bytes are */</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*r */</span>	<span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>comp;       <span style="color:#998;font-style:italic">/* only used with decompression - malloc()ed */</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*r */</span>  <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">long</span> epoch;       <span style="color:#998;font-style:italic">/* epoch number, needed by DTLS1 */</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*r */</span>  <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> seq_num[<span style="color:#099">8</span>];  <span style="color:#998;font-style:italic">/* sequence number, needed by DTLS1 */</span>
</span></span><span style="display:flex;"><span>} SSL3_RECORD;
</span></span></code></pre></div><p>由此可知，函数第一行的指针p，指向 SSL3 记录数据，即心跳消息。函数体即处理该心跳消息。</p>
<p>接下来还原函数逻辑与漏洞原因：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#ifndef OPENSSL_NO_HEARTBEATS
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span>
</span></span><span style="display:flex;"><span><span style="color:#900;font-weight:bold">dtls1_process_heartbeat</span>(SSL <span style="color:#000;font-weight:bold">*</span>s)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>p <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">&amp;</span>s<span style="color:#000;font-weight:bold">-&gt;</span>s3<span style="color:#000;font-weight:bold">-&gt;</span>rrec.data[<span style="color:#099">0</span>], <span style="color:#000;font-weight:bold">*</span>pl; <span style="color:#998;font-style:italic">// p指向SSL3请求包中的心跳消息
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">short</span> hbtype; <span style="color:#998;font-style:italic">// 心跳包类型
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">int</span> payload; <span style="color:#998;font-style:italic">// 心跳请求包payload长度
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">int</span> padding <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">16</span>; <span style="color:#998;font-style:italic">/* Use minimum padding */</span> <span style="color:#998;font-style:italic">// 心跳请求包padding长度
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">/* Read type and payload length first */</span>
</span></span><span style="display:flex;"><span>    hbtype <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">*</span>p<span style="color:#000;font-weight:bold">++</span>; <span style="color:#998;font-style:italic">// 心跳包类型 = 1，为心跳请求包
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    n2s(p, payload); <span style="color:#998;font-style:italic">// 使用n2s宏从请求包中取两个字节的载荷长度赋给变量payload，并将p指针后移2个字节，此后指针p指向心跳包载荷
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    pl <span style="color:#000;font-weight:bold">=</span> p; <span style="color:#998;font-style:italic">// pl指向心跳包载荷
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (s<span style="color:#000;font-weight:bold">-&gt;</span>msg_callback)
</span></span><span style="display:flex;"><span>        s<span style="color:#000;font-weight:bold">-&gt;</span>msg_callback(<span style="color:#099">0</span>, s<span style="color:#000;font-weight:bold">-&gt;</span>version, TLS1_RT_HEARTBEAT,
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&amp;</span>s<span style="color:#000;font-weight:bold">-&gt;</span>s3<span style="color:#000;font-weight:bold">-&gt;</span>rrec.data[<span style="color:#099">0</span>], s<span style="color:#000;font-weight:bold">-&gt;</span>s3<span style="color:#000;font-weight:bold">-&gt;</span>rrec.length,
</span></span><span style="display:flex;"><span>            s, s<span style="color:#000;font-weight:bold">-&gt;</span>msg_callback_arg);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (hbtype <span style="color:#000;font-weight:bold">==</span> TLS1_HB_REQUEST) <span style="color:#998;font-style:italic">// 若心跳包类型为 TLS1_HB_REQUEST，是一个请求包
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">char</span> <span style="color:#000;font-weight:bold">*</span>buffer, <span style="color:#000;font-weight:bold">*</span>bp;
</span></span><span style="display:flex;"><span>        <span style="color:#458;font-weight:bold">int</span> r;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">/* Allocate memory for the response, size is 1 byte
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * message type, plus 2 bytes payload length, plus
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * payload, plus padding
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         */</span>
</span></span><span style="display:flex;"><span>        buffer <span style="color:#000;font-weight:bold">=</span> OPENSSL_malloc(<span style="color:#099">1</span> <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">2</span> <span style="color:#000;font-weight:bold">+</span> payload <span style="color:#000;font-weight:bold">+</span> padding); <span style="color:#998;font-style:italic">// 依据请求包中记录的payload与padding长度，为心跳响应包分配内存
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        bp <span style="color:#000;font-weight:bold">=</span> buffer;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">/* Enter response type, length and copy payload */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">*</span>bp<span style="color:#000;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">=</span> TLS1_HB_RESPONSE; <span style="color:#998;font-style:italic">// 填充 1 byte 的心跳包类型 = 0x02，为心跳响应包
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        s2n(payload, bp); <span style="color:#998;font-style:italic">// 填充 2 bytes 的载荷长度
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        memcpy(bp, pl, payload); <span style="color:#998;font-style:italic">/* 填充心跳响应包载荷（由用户提供）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        						  * 由于心跳包载荷长度（payload）完全由来自请求包，由用户控制
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        						  * 故此处若payload变量值大于实际payload大小
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        						  * 就会导致额外的数据被拷贝至响应包
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        						  * 进而造成信息泄露 */</span>
</span></span><span style="display:flex;"><span>        bp <span style="color:#000;font-weight:bold">+=</span> payload; <span style="color:#998;font-style:italic">// 指针后移payload字节
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#998;font-style:italic">/* Random padding */</span>
</span></span><span style="display:flex;"><span>        RAND_pseudo_bytes(bp, padding); <span style="color:#998;font-style:italic">// 填充随机字节
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>        r <span style="color:#000;font-weight:bold">=</span> dtls1_write_bytes(s, TLS1_RT_HEARTBEAT, buffer, <span style="color:#099">3</span> <span style="color:#000;font-weight:bold">+</span> payload <span style="color:#000;font-weight:bold">+</span> padding); <span style="color:#998;font-style:italic">// 将构造好的心跳响应包写入 SSL3_RECORD 中，并返回给客户端
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> (r <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> s<span style="color:#000;font-weight:bold">-&gt;</span>msg_callback)
</span></span><span style="display:flex;"><span>            s<span style="color:#000;font-weight:bold">-&gt;</span>msg_callback(<span style="color:#099">1</span>, s<span style="color:#000;font-weight:bold">-&gt;</span>version, TLS1_RT_HEARTBEAT,
</span></span><span style="display:flex;"><span>                buffer, <span style="color:#099">3</span> <span style="color:#000;font-weight:bold">+</span> payload <span style="color:#000;font-weight:bold">+</span> padding,
</span></span><span style="display:flex;"><span>                s, s<span style="color:#000;font-weight:bold">-&gt;</span>msg_callback_arg);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        OPENSSL_free(buffer);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> (r <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">0</span>)                                                                       
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">return</span> r;                                                                     
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> (hbtype <span style="color:#000;font-weight:bold">==</span> TLS1_HB_RESPONSE)                                                     {                                                                                     
</span></span><span style="display:flex;"><span>        <span style="color:#458;font-weight:bold">unsigned</span> <span style="color:#458;font-weight:bold">int</span> seq;   
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">/* We only send sequence numbers (2 bytes unsigned int),
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * and 16 random bytes, so we just try to read the
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * sequence number */</span>
</span></span><span style="display:flex;"><span>        n2s(pl, seq);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> (payload <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">18</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> seq <span style="color:#000;font-weight:bold">==</span> s<span style="color:#000;font-weight:bold">-&gt;</span>tlsext_hb_seq)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            dtls1_stop_timer(s);
</span></span><span style="display:flex;"><span>            s<span style="color:#000;font-weight:bold">-&gt;</span>tlsext_hb_seq<span style="color:#000;font-weight:bold">++</span>;
</span></span><span style="display:flex;"><span>            s<span style="color:#000;font-weight:bold">-&gt;</span>tlsext_hb_pending <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="漏洞修复">漏洞修复</h2>
<p>git 查看漏洞修复前后版本差异：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git diff OpenSSL_1_0_1f OpenSSL_1_0_1g
</span></span></code></pre></div><p>定位到<code>dtls1_process_heartbeat</code>函数，得到：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-diff" data-lang="diff"><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-Version: 1.0.1f
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+Version: 1.0.1g
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span> Source0: ftp://ftp.openssl.org/source/%{name}-%{version}.tar.gz
</span></span><span style="display:flex;"><span> License: OpenSSL
</span></span><span style="display:flex;"><span> Group: System Environment/Libraries
</span></span><span style="display:flex;"><span><span style="color:#999">diff --git a/ssl/d1_both.c b/ssl/d1_both.c
</span></span></span><span style="display:flex;"><span><span style="color:#999">index 7a5596a6b3..2e8cf681ed 100644
</span></span></span><span style="display:flex;"><span><span style="color:#999"></span><span style="color:#000;background-color:#fdd">--- a/ssl/d1_both.c
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+++ b/ssl/d1_both.c
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span><span style="color:#aaa">@@ -1459,26 +1459,36 @@ dtls1_process_heartbeat(SSL *s)
</span></span></span><span style="display:flex;"><span><span style="color:#aaa"></span>        unsigned int payload;
</span></span><span style="display:flex;"><span>        unsigned int padding = 16; /* Use minimum padding */
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-       /* Read type and payload length first */
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-       hbtype = *p++;
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-       n2s(p, payload);
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-       pl = p;
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd"></span>        if (s-&gt;msg_callback)
</span></span><span style="display:flex;"><span>                s-&gt;msg_callback(0, s-&gt;version, TLS1_RT_HEARTBEAT,
</span></span><span style="display:flex;"><span>                        &amp;s-&gt;s3-&gt;rrec.data[0], s-&gt;s3-&gt;rrec.length,
</span></span><span style="display:flex;"><span>                        s, s-&gt;msg_callback_arg);
</span></span><span style="display:flex;"><span>        # 添加的检查1：当实际心跳载荷（payload）长度为0时，函数返回0
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+       /* Read type and payload length first */
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+       if (1 + 2 + 16 &gt; s-&gt;s3-&gt;rrec.length)
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+               return 0; /* silently discard */
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span>
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+       hbtype = *p++;
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+       n2s(p, payload);
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span>        # 添加的检查2：当计算得心跳消息长度大于SSL3数据包长度时（两者应该等同），即心跳包载荷长度（payload length）大于实际载荷（payload）的长度时，函数返回0
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+       if (1 + 2 + payload + 16 &gt; s-&gt;s3-&gt;rrec.length)
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+               return 0; /* silently discard per RFC 6520 sec. 4 */
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+       pl = p;
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span>        if (hbtype == TLS1_HB_REQUEST)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                unsigned char *buffer, *bp;
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+               unsigned int write_length = 1 /* heartbeat type */ +
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+                                           2 /* heartbeat length */ +
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+                                           payload + padding;
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span>                int r;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+               if (write_length &gt; SSL3_RT_MAX_PLAIN_LENGTH)
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+                       return 0;
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd">+
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span>                /* Allocate memory for the response, size is 1 byte
</span></span><span style="display:flex;"><span>                 * message type, plus 2 bytes payload length, plus
</span></span><span style="display:flex;"><span>                 * payload, plus padding
</span></span><span style="display:flex;"><span>                 */
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-               buffer = OPENSSL_malloc(1 + 2 + payload + padding);
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+               buffer = OPENSSL_malloc(write_length);
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span>                bp = buffer;
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>                /* Enter response type, length and copy payload */
</span></span><span style="display:flex;"><span><span style="color:#aaa">@@ -1489,11 +1499,11 @@ dtls1_process_heartbeat(SSL *s)
</span></span></span><span style="display:flex;"><span><span style="color:#aaa"></span>                /* Random padding */
</span></span><span style="display:flex;"><span>                RAND_pseudo_bytes(bp, padding);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-               r = dtls1_write_bytes(s, TLS1_RT_HEARTBEAT, buffer, 3 + payload + padding);
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+               r = dtls1_write_bytes(s, TLS1_RT_HEARTBEAT, buffer, write_length);
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span> 
</span></span><span style="display:flex;"><span>                if (r &gt;= 0 &amp;&amp; s-&gt;msg_callback)
</span></span><span style="display:flex;"><span>                        s-&gt;msg_callback(1, s-&gt;version, TLS1_RT_HEARTBEAT,
</span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd">-                               buffer, 3 + payload + padding,
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#fdd"></span><span style="color:#000;background-color:#dfd">+                               buffer, write_length,
</span></span></span><span style="display:flex;"><span><span style="color:#000;background-color:#dfd"></span>                                s, s-&gt;msg_callback_arg);
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>                OPENSSL_free(buffer);
</span></span></code></pre></div><h1 id="fuzzing-挖掘-cve-2014-0160">Fuzzing 挖掘 CVE-2014-0160</h1>
<p>使用Google的<a href="https://github.com/google/fuzzer-test-suite">fuzzer-test-suite</a>来实践，先构建包含漏洞的openssl：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git clone https://github.com/google/fuzzer-test-suite.git
</span></span><span style="display:flex;"><span>mkdir CVE-2014-0160; <span style="color:#0086b3">cd</span> CVE-2014-0160
</span></span><span style="display:flex;"><span>../fuzzer-test-suite/openssl-1.0.1f/build.sh
</span></span></code></pre></div><p>This command will download the openssl sources at the affected revision and build the fuzzer for one specific API that has the bug, see <a href="https://github.com/google/fuzzer-test-suite/blob/master/openssl-1.0.1f/target.cc">openssl-1.0.1f/target.cc</a>：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Copyright 2016 Google Inc. All Rights Reserved.
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;openssl/ssl.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;openssl/err.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;assert.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stdint.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&lt;stddef.h&gt;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span>SSL_CTX <span style="color:#000;font-weight:bold">*</span><span style="color:#900;font-weight:bold">Init</span>() {
</span></span><span style="display:flex;"><span>  SSL_library_init();
</span></span><span style="display:flex;"><span>  SSL_load_error_strings();
</span></span><span style="display:flex;"><span>  ERR_load_BIO_strings();
</span></span><span style="display:flex;"><span>  OpenSSL_add_all_algorithms();
</span></span><span style="display:flex;"><span>  SSL_CTX <span style="color:#000;font-weight:bold">*</span>sctx;
</span></span><span style="display:flex;"><span>  assert (sctx <span style="color:#000;font-weight:bold">=</span> SSL_CTX_new(TLSv1_method()));
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">/* These two file were created with this command:
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">      openssl req -x509 -newkey rsa:512 -keyout server.key \
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     -out server.pem -days 9999 -nodes -subj /CN=a/
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  */</span>
</span></span><span style="display:flex;"><span>  assert(SSL_CTX_use_certificate_file(sctx, <span style="color:#d14">&#34;runtime/server.pem&#34;</span>,
</span></span><span style="display:flex;"><span>                                      SSL_FILETYPE_PEM));
</span></span><span style="display:flex;"><span>  assert(SSL_CTX_use_PrivateKey_file(sctx, <span style="color:#d14">&#34;runtime/server.key&#34;</span>,
</span></span><span style="display:flex;"><span>                                     SSL_FILETYPE_PEM));
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> sctx;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">extern</span> <span style="color:#d14">&#34;C&#34;</span> <span style="color:#458;font-weight:bold">int</span> LLVMFuzzerTestOneInput(<span style="color:#000;font-weight:bold">const</span> <span style="color:#458;font-weight:bold">uint8_t</span> <span style="color:#000;font-weight:bold">*</span>Data, size_t Size) {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">static</span> SSL_CTX <span style="color:#000;font-weight:bold">*</span>sctx <span style="color:#000;font-weight:bold">=</span> Init();
</span></span><span style="display:flex;"><span>  SSL <span style="color:#000;font-weight:bold">*</span>server <span style="color:#000;font-weight:bold">=</span> SSL_new(sctx);
</span></span><span style="display:flex;"><span>  BIO <span style="color:#000;font-weight:bold">*</span>sinbio <span style="color:#000;font-weight:bold">=</span> BIO_new(BIO_s_mem());
</span></span><span style="display:flex;"><span>  BIO <span style="color:#000;font-weight:bold">*</span>soutbio <span style="color:#000;font-weight:bold">=</span> BIO_new(BIO_s_mem());
</span></span><span style="display:flex;"><span>  SSL_set_bio(server, sinbio, soutbio);
</span></span><span style="display:flex;"><span>  SSL_set_accept_state(server);
</span></span><span style="display:flex;"><span>  BIO_write(sinbio, Data, Size);
</span></span><span style="display:flex;"><span>  SSL_do_handshake(server);
</span></span><span style="display:flex;"><span>  SSL_free(server);
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>构建完成后运行刚刚编译好的fuzzer：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>./openssl-1.0.1f-fsanitize_fuzzer
</span></span></code></pre></div><p>就能跑出：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">=================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">==</span><span style="color:#008080">2190163</span><span style="color:#000;font-weight:bold">==</span>ERROR: AddressSanitizer: heap-buffer-overflow on address 0x629000009748 at pc 0x00000051d75a bp 0x7fff7d14a450 sp 0x7fff7d149c18
</span></span><span style="display:flex;"><span>READ of size <span style="color:#099">33536</span> at 0x629000009748 thread T0
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#0 0x51d759 in __asan_memcpy (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x51d759)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#1 0x55c283 in tls1_process_heartbeat /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/t1_lib.c:2586:3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#2 0x5c7321 in ssl3_read_bytes /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_pkt.c:1092:4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#3 0x5cb7f3 in ssl3_get_message /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_both.c:457:7</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#4 0x597c86 in ssl3_get_client_hello /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_srvr.c:941:4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#5 0x593b21 in ssl3_accept /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_srvr.c:357:9</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#6 0x55052d in LLVMFuzzerTestOneInput /root/lab/fuzzing_baby/CVE-2014-0160/../fuzzer-test-suite/openssl-1.0.1f/target.cc:34:3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#7 0x4587a1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x4587a1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#8 0x457ee5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x457ee5)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#9 0x45a187 in fuzzer::Fuzzer::MutateAndTestOne() (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x45a187)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#10 0x45ae85 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, fuzzer::fuzzer_allocator&lt;fuzzer::SizedFile&gt; &gt;&amp;) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x45ae85)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#11 0x44983e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x44983e)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#12 0x472682 in main (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x472682)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#13 0x7f58322b0082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#14 0x41e5dd in _start (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x41e5dd)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>0x629000009748 is located <span style="color:#099">0</span> bytes to the right of 17736-byte region <span style="color:#000;font-weight:bold">[</span>0x629000005200,0x629000009748<span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>allocated by thread T0 here:
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#0 0x51e30d in malloc (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x51e30d)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#1 0x5fab2b in CRYPTO_malloc /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/crypto/mem.c:308:8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#2 0x5ccf07 in freelist_extract /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_both.c:708:12</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#3 0x5ccf07 in ssl3_setup_read_buffer /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_both.c:770:10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#4 0x5cd51c in ssl3_setup_buffers /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_both.c:827:7</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#5 0x59474f in ssl3_accept /root/lab/fuzzing_baby/CVE-2014-0160/BUILD/ssl/s3_srvr.c:292:9</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#6 0x55052d in LLVMFuzzerTestOneInput /root/lab/fuzzing_baby/CVE-2014-0160/../fuzzer-test-suite/openssl-1.0.1f/target.cc:34:3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#7 0x4587a1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x4587a1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#8 0x45a4da in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__Fuzzer::vector&lt;fuzzer::SizedFile, fuzzer::fuzzer_allocator&lt;fuzzer::SizedFile&gt; &gt;&amp;) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x45a4da)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#9 0x45ab69 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector&lt;fuzzer::SizedFile, fuzzer::fuzzer_allocator&lt;fuzzer::SizedFile&gt; &gt;&amp;) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x45ab69)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#10 0x44983e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x44983e)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#11 0x472682 in main (/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x472682)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#12 0x7f58322b0082 in __libc_start_main /build/glibc-SzIz7B/glibc-2.31/csu/../csu/libc-start.c:308:16</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SUMMARY: AddressSanitizer: heap-buffer-overflow <span style="color:#000;font-weight:bold">(</span>/f/lab/fuzzing_baby/CVE-2014-0160/openssl-1.0.1f-fsanitize_fuzzer+0x51d759<span style="color:#000;font-weight:bold">)</span> in __asan_memcpy
</span></span><span style="display:flex;"><span>Shadow bytes around the buggy address:
</span></span><span style="display:flex;"><span>  0x0c527fff9290: <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span>
</span></span><span style="display:flex;"><span>  0x0c527fff92a0: <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span>
</span></span><span style="display:flex;"><span>  0x0c527fff92b0: <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span>
</span></span><span style="display:flex;"><span>  0x0c527fff92c0: <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span>
</span></span><span style="display:flex;"><span>  0x0c527fff92d0: <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#008080">00</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">=</span>&gt;0x0c527fff92e0: <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> <span style="color:#099">00</span> 00<span style="color:#000;font-weight:bold">[</span>fa<span style="color:#000;font-weight:bold">]</span>fa fa fa fa fa fa
</span></span><span style="display:flex;"><span>  0x0c527fff92f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span style="display:flex;"><span>  0x0c527fff9300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span style="display:flex;"><span>  0x0c527fff9310: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span style="display:flex;"><span>  0x0c527fff9320: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span style="display:flex;"><span>  0x0c527fff9330: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
</span></span><span style="display:flex;"><span>Shadow byte legend <span style="color:#000;font-weight:bold">(</span>one shadow byte represents <span style="color:#099">8</span> application bytes<span style="color:#000;font-weight:bold">)</span>:
</span></span><span style="display:flex;"><span>  Addressable:           <span style="color:#099">00</span>
</span></span><span style="display:flex;"><span>  Partially addressable: <span style="color:#099">01</span> <span style="color:#099">02</span> <span style="color:#099">03</span> <span style="color:#099">04</span> <span style="color:#099">05</span> <span style="color:#099">06</span> <span style="color:#099">07</span>
</span></span><span style="display:flex;"><span>  Heap left redzone:       fa
</span></span><span style="display:flex;"><span>  Freed heap region:       fd
</span></span><span style="display:flex;"><span>  Stack left redzone:      f1
</span></span><span style="display:flex;"><span>  Stack mid redzone:       f2
</span></span><span style="display:flex;"><span>  Stack right redzone:     f3
</span></span><span style="display:flex;"><span>  Stack after <span style="color:#000;font-weight:bold">return</span>:      f5
</span></span><span style="display:flex;"><span>  Stack use after scope:   f8
</span></span><span style="display:flex;"><span>  Global redzone:          f9
</span></span><span style="display:flex;"><span>  Global init order:       f6
</span></span><span style="display:flex;"><span>  Poisoned by user:        f7
</span></span><span style="display:flex;"><span>  Container overflow:      <span style="color:#0086b3">fc</span>
</span></span><span style="display:flex;"><span>  Array cookie:            ac
</span></span><span style="display:flex;"><span>  Intra object redzone:    bb
</span></span><span style="display:flex;"><span>  ASan internal:           fe
</span></span><span style="display:flex;"><span>  Left alloca redzone:     ca
</span></span><span style="display:flex;"><span>  Right alloca redzone:    cb
</span></span><span style="display:flex;"><span>  Shadow gap:              <span style="color:#008080">cc</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">==</span><span style="color:#008080">2190163</span><span style="color:#000;font-weight:bold">==</span>ABORTING
</span></span><span style="display:flex;"><span>MS: <span style="color:#099">1</span> CopyPart-; base unit: 380cd810619fc15deda5a170f6bec4cfd229086b
</span></span><span style="display:flex;"><span>0x18,0x3,0x29,0x0,0x1,0x1,0x0,
</span></span><span style="display:flex;"><span><span style="color:#d14">\x</span>18<span style="color:#d14">\x</span>03<span style="color:#000;font-weight:bold">)</span><span style="color:#d14">\x</span>00<span style="color:#d14">\x</span>01<span style="color:#d14">\x</span>01<span style="color:#d14">\x</span><span style="color:#099">00</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">artifact_prefix</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;./&#39;</span>; Test unit written to ./crash-8f882413170d68fb148303a53b5208b0f2dc61cc
</span></span><span style="display:flex;"><span>Base64: <span style="color:#008080">GAMpAAEBAA</span><span style="color:#000;font-weight:bold">==</span>
</span></span></code></pre></div></div>
  
</article>
<button class="floating-button">
    <a class="floating-button__link" href="https://cerr.cc/">
        <span style="font-size: large; font-family: monospace; font-weight: bolder;">~</span>
    </a>
</button>


    </div>
    
    <footer class="post-footer">
    <div class="footer">
        
            <div>© 2022, Zikey Vi</div>
        
        <div class="footer__socials">


<a
  href="mailto:dev2ero@foxmail.com"
  target="_blank"
  class="social-link"
  rel="noopener"
>
  <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Gmail</title><path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"/></svg>
</a>&nbsp;&nbsp;



<a
  href="https://github.com/dev2ero"
  target="_blank"
  class="social-link"
  rel="noopener"
>
  <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
</a>&nbsp;&nbsp;



<a
  href="https://twitter.com/dev2ero"
  target="_blank"
  class="social-link"
  rel="noopener"
>
  <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
</a>&nbsp;&nbsp;



<a
  href="https://space.bilibili.com/210892014"
  target="_blank"
  class="social-link"
  rel="noopener"
>
  <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Bilibili</title><path d="M17.813 4.653h.854c1.51.054 2.769.578 3.773 1.574 1.004.995 1.524 2.249 1.56 3.76v7.36c-.036 1.51-.556 2.769-1.56 3.773s-2.262 1.524-3.773 1.56H5.333c-1.51-.036-2.769-.556-3.773-1.56S.036 18.858 0 17.347v-7.36c.036-1.511.556-2.765 1.56-3.76 1.004-.996 2.262-1.52 3.773-1.574h.774l-1.174-1.12a1.234 1.234 0 0 1-.373-.906c0-.356.124-.658.373-.907l.027-.027c.267-.249.573-.373.92-.373.347 0 .653.124.92.373L9.653 4.44c.071.071.134.142.187.213h4.267a.836.836 0 0 1 .16-.213l2.853-2.747c.267-.249.573-.373.92-.373.347 0 .662.151.929.4.267.249.391.551.391.907 0 .355-.124.657-.373.906zM5.333 7.24c-.746.018-1.373.276-1.88.773-.506.498-.769 1.13-.786 1.894v7.52c.017.764.28 1.395.786 1.893.507.498 1.134.756 1.88.773h13.334c.746-.017 1.373-.275 1.88-.773.506-.498.769-1.129.786-1.893v-7.52c-.017-.765-.28-1.396-.786-1.894-.507-.497-1.134-.755-1.88-.773zM8 11.107c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c0-.373.129-.689.386-.947.258-.257.574-.386.947-.386zm8 0c.373 0 .684.124.933.373.25.249.383.569.4.96v1.173c-.017.391-.15.711-.4.96-.249.25-.56.374-.933.374s-.684-.125-.933-.374c-.25-.249-.383-.569-.4-.96V12.44c.017-.391.15-.711.4-.96.249-.249.56-.373.933-.373Z"/></svg>
</a>

</div>
    </div>
</footer>


    
    
      
<script src="https://cerr.cc/js/script.js"></script>

    
  </body>
</html>
